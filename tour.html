<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Pantai Losari 360°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <style>
    body { margin: 0; overflow: hidden; }
    .a-canvas { cursor: crosshair; }

    /* Animasi hover bundaran */
    .hotspot { animation: pulse 2s infinite; }

    @keyframes pulse {
      0%, 100% { scale: 1; opacity: 0.8; }
      50% { scale: 1.2; opacity: 1; }
    }
  </style>
</head>

<body>
  <audio autoplay hidden loop>a
    <source src="sound/Angin_Mamiri.mp3" type="audio/mpeg" />
  </audio>

  <a-scene>
    <!-- Semua aset 13 panorama -->
    <a-assets>
      <img id="pano-1" src="images/pano1.jpg" crossorigin="anonymous" />
      <img id="pano-2" src="images/pano2.jpg" crossorigin="anonymous" />
      <img id="pano-3" src="images/pano3.jpg" crossorigin="anonymous" />
      <img id="pano-4" src="images/pano4.jpg" crossorigin="anonymous" />
      <img id="pano-5" src="images/pano5.jpg" crossorigin="anonymous" />
      <img id="pano-6" src="images/pano6.jpg" crossorigin="anonymous" />
      <img id="pano-7" src="images/pano7.jpg" crossorigin="anonymous" />
      <img id="pano-8" src="images/pano8.jpg" crossorigin="anonymous" />
      <img id="pano-9" src="images/pano9.jpg" crossorigin="anonymous" />
      <img id="pano-10" src="images/pano10.jpg" crossorigin="anonymous" />
      <img id="pano-11" src="images/pano11.jpg" crossorigin="anonymous" />
      <img id="pano-12" src="images/pano12.jpg" crossorigin="anonymous" />
      <img id="pano-13" src="images/pano13.jpg" crossorigin="anonymous" />
    </a-assets>

    <!-- Sky -->
    <a-sky id="sky" src="#pano-1" rotation="0 -90 0"></a-sky>

    <!-- Hotspot kiri -->
    <a-entity id="leftHotspot" position="-2 0 -2" rotation="0 45 0">
      <a-circle color="#800000" radius="0.25" opacity="0.9" class="hotspot"></a-circle>
      <a-text value="←" color="#fff" align="center" position="0 0 0.01" scale="2 2 2"></a-text>
    </a-entity>

    <!-- Hotspot kanan -->
    <a-entity id="rightHotspot" position="2 0 -2" rotation="0 -45 0">
      <a-circle color="#800000" radius="0.25" opacity="0.9" class="hotspot"></a-circle>
      <a-text value="→" color="#fff" align="center" position="0 0 0.01" scale="2 2 2"></a-text>
    </a-entity>

    <!-- Kamera -->
    <a-entity camera look-controls position="0 1.6 0" rotation="0 0 0">
      <a-entity 
        cursor="fuse: true; fuseTimeout: 1000"
        position="0 0 -1"
        geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
        material="color: white; opacity: 0.8; shader: flat">
      </a-entity>
    </a-entity>
  </a-scene>

  <script>
    const panoramas = [
      '#pano-1', '#pano-2', '#pano-3', '#pano-4', '#pano-5',
      '#pano-6', '#pano-7', '#pano-8', '#pano-9', '#pano-10',
      '#pano-11', '#pano-12', '#pano-13'
    ];

    let currentIndex = 0;
    const sky = document.querySelector('#sky');

    function setPanorama(index) {
      if (index < 0) index = panoramas.length - 1;
      if (index >= panoramas.length) index = 0;
      currentIndex = index;

      // Fade sederhana
      sky.setAttribute('animation__fadeout', {
        property: 'material.opacity',
        from: 1,
        to: 0,
        dur: 500,
        easing: 'easeInOutQuad'
      });
      sky.emit('fadeout');

      setTimeout(() => {
        sky.setAttribute('src', panoramas[currentIndex]);
        sky.setAttribute('animation__fadein', {
          property: 'material.opacity',
          from: 0,
          to: 1,
          dur: 500,
          easing: 'easeInOutQuad'
        });
        sky.emit('fadein');
      }, 500);
    }

    const leftHotspot = document.querySelector('#leftHotspot');
    const rightHotspot = document.querySelector('#rightHotspot');

    // Fungsi hover dengan “loading” 1 detik
    function setupHover(el, callback) {
      let timer;
      const circle = el.querySelector('a-circle');

      el.addEventListener('mouseenter', () => {
        // Animasi progres bisa ditambahkan jika mau
        circle.setAttribute('animation__scale', {
          property: 'scale',
          to: '1.4 1.4 1.4',
          dur: 1000,
          easing: 'easeInOutQuad'
        });
        timer = setTimeout(callback, 1000); // 1 detik hover = pindah panorama
      });

      el.addEventListener('mouseleave', () => {
        circle.removeAttribute('animation__scale');
        clearTimeout(timer);
      });
    }

    setupHover(leftHotspot, () => setPanorama(currentIndex - 1));
    setupHover(rightHotspot, () => setPanorama(currentIndex + 1));
  </script>
</body>
</html>


